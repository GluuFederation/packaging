#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

#export DH_ALWAYS_EXCLUDE=GIT:.gitignore

%:
	dh $@ 

override_dh_install:
	dh_install
	find ./debian/gluu-server -name "*.gitignore" -delete
override_dh_perl:
override_dh_link:
override_dh_strip:
override_dh_compress:
override_dh_makeshlibs:
override_dh_shlibdeps:
override_dh_strip_nondeterminism:
override_dh_fixperms:
	dh_fixperms
	chmod 755 ./debian/gluu-server/opt/gluu-server/lib/x86_64-linux-gnu/ld-2.27.so
	chmod 755 ./debian/gluu-server/opt/gluu-server/lib/x86_64-linux-gnu/libc-2.27.so
	chmod 755 ./debian/gluu-server/opt/gluu-server/lib/x86_64-linux-gnu/libpthread-2.27.so
	chmod 755 ./debian/gluu-server/opt/gluu-server/install/community-edition-setup/setup_casa.py
	chmod 755 ./debian/gluu-server/opt/gluu-server/install/community-edition-setup/casa_cleanup.py
	chmod 755 ./debian/gluu-server/opt/gluu-server/opt/gluu/python/libs/casa-external_otp.py
	chmod 755 ./debian/gluu-server/opt/gluu-server/opt/gluu/python/libs/casa-external_super_gluu.py
	chmod 755 ./debian/gluu-server/opt/gluu-server/opt/gluu/python/libs/casa-external_twilio_sms.py
	chmod 755 ./debian/gluu-server/opt/gluu-server/opt/gluu/python/libs/casa-external_u2f.py
	chmod 755 ./debian/gluu-server/opt/gluu-server/opt/gluu/python/libs/casa-external_fido2.py
	chmod 755 ./debian/gluu-server/opt/gluu-server/opt/dist/gluu/casa-al/casa.py
	chmod 755 ./debian/gluu-server/opt/gluu-server/opt/oxd-server/bin/oxd-start.sh
	chmod 755 ./debian/gluu-server/opt/gluu-server/opt/oxd-server/bin/lsox.sh
	chown -R jetty:jetty ./debian/gluu-server/opt/gluu-server/opt/oxd-server/data
	chmod 764 ./debian/gluu-server/opt/gluu-server/opt/oxd-server/data	
